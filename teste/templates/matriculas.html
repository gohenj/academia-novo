{% extends "layout.html" %}

{% block content %}
    <h2>Gerenciar Matrículas</h2>
    
    <div class="card mb-4">
        <div class="card-header">Realizar Nova Matrícula</div>
        <div class="card-body">
            <form action="{{ url_for('matriculas') }}" method="POST">
                <div class="row g-3">
                    <div class="col-md-2">
                        <label class="form-label">Cód. Matrícula</label>
                        <input type="number" class="form-control" name="cod_matricula" placeholder="Código" required>
                    </div>
                    <div class="col-md-5">
                        <label class="form-label">Aluno</label>
                        <select name="cod_aluno" class="form-select" required>
                            <option value="">Selecione o Aluno...</option>
                            {% for aluno in alunos %}
                            <option value="{{ aluno.cod_aluno }}">{{ aluno.nome }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="col-md-5">
                        <label class="form-label">Modalidade</label>
                        <select name="cod_modalidade" class="form-select" required>
                            <option value="">Selecione a Modalidade...</option>
                            {% for modalidade in modalidades %}
                            <option value="{{ modalidade.cod_modalidade }}">{{ modalidade.descricao }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
                <div class="row g-3 mt-2">
                     <div class="col-md-4">
                        <label class="form-label">Quantidade de Aulas</label>
                        <input type="number" class="form-control" name="qtde_aulas" placeholder="Ex: 8" required>
                    </div>
                    <div class="col-md-8 d-flex align-items-end">
                        <button type="submit" class="btn btn-primary w-100">Realizar Matrícula</button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <table class="table table-striped table-hover">
        <thead>
            <tr>
                <th>Cód. Matrícula</th>
                <th>Aluno</th>
                <th>Modalidade</th>
                <th>Qtd. Aulas</th>
                <th>Valor a Pagar</th>
                <th>Ações</th>
            </tr>
        </thead>
        <tbody>
            {% for matricula in matriculas %}
            <tr>
                <td>{{ matricula.cod_matricula }}</td>
                <td>{{ matricula.aluno_nome }}</td>
                <td>{{ matricula.modalidade_desc }}</td>
                <td>{{ matricula.qtde_aulas }}</td>
                <td>R$ {{ matricula.valor_a_pagar }}</td>
                <td>
                    <a href="{{ url_for('excluir_matricula', cod=matricula.cod_matricula) }}" class="btn btn-danger btn-sm"
                       onclick="return confirm('Tem certeza?');">Excluir</a>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="6" class="text-center">Nenhuma matrícula realizada.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% endblock %}
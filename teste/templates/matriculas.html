{% extends "layout.html" %}

{% block content %}
    <h2>Gerenciar Matrículas</h2>
    
    <div class="card mb-4">
        <div class="card-header">Realizar Nova Matrícula</div>
        <div class="card-body">
            <form action="{{ url_for('matriculas') }}" method="POST" novalidate>
                {{ form.hidden_tag() }}

                <div class="row g-3">
                    <div class="col-md-2">
                        {{ form.cod_matricula.label(class="form-label") }}
                        {{ form.cod_matricula(class="form-control", placeholder="Código") }}
                        {% for error in form.cod_matricula.errors %}
                            <div class="text-danger small mt-1">{{ error }}</div>
                        {% endfor %}
                    </div>
                    <div class="col-md-5">
                        {{ form.cod_aluno.label(class="form-label") }}
                        {{ form.cod_aluno(class="form-select") }}
                        {% for error in form.cod_aluno.errors %}
                            <div class="text-danger small mt-1">{{ error }}</div>
                        {% endfor %}
                    </div>
                    <div class="col-md-5">
                        {{ form.cod_modalidade.label(class="form-label") }}
                        {{ form.cod_modalidade(class="form-select") }}
                        {% for error in form.cod_modalidade.errors %}
                            <div class="text-danger small mt-1">{{ error }}</div>
                        {% endfor %}
                    </div>
                </div>

                <div class="row g-3 mt-2">
                     <div class="col-md-4">
                        {{ form.qtde_aulas.label(class="form-label") }}
                        {{ form.qtde_aulas(class="form-control", placeholder="Ex: 8") }}
                        {% for error in form.qtde_aulas.errors %}
                            <div class="text-danger small mt-1">{{ error }}</div>
                        {% endfor %}
                    </div>
                    <div class="col-md-8 d-flex align-items-end">
                        {{ form.submit(class="btn btn-primary w-100") }}
                    </div>
                </div>
            </form>
        </div>
    </div>

    <table class="table table-striped table-hover">
        <thead class="table-dark">
            <tr>
                <th>Cód. Matrícula</th>
                <th>Aluno</th>
                <th>Modalidade</th>
                <th>Qtd. Aulas</th>
                <th>Valor a Pagar</th>
                <th>Ações</th>
            </tr>
        </thead>
        <tbody>
            {% for matricula in matriculas %}
            <tr>
                <td>{{ matricula.cod_matricula }}</td>
                <td>{{ matricula.aluno_nome }}</td>
                <td>{{ matricula.modalidade_desc }}</td>
                <td>{{ matricula.qtde_aulas }}</td>
                <td>R$ {{ matricula.valor_a_pagar }}</td>
                <td>
                    <a href="{{ url_for('excluir_matricula', cod=matricula.cod_matricula) }}" class="btn btn-danger btn-sm"
                       onclick="return confirm('Tem certeza?');">Excluir</a>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="6" class="text-center">Nenhuma matrícula realizada.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% endblock %}

